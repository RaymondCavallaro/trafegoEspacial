<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/WEB-INF/templates/padraoContencioso.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

	<ui:define name="title">#{msg['page.processo.title']}</ui:define>
	<ui:define name="content">

		<p:growl id="growl" showDetail="true" life="60000" />
		<h:form id="listForm">
			<p:panel style="margin-bottom:5px; font-size: 12px;">
				<p:panelGrid columns="2" layout="grid">
					<h:panelGrid columns="1">
						<h:outputText value="Possui audiência: " style="font-weight: bold" />
						<h:panelGrid columns="2">
							<p:selectBooleanCheckbox label="Possui audiência"
								value="#{inicialDeProcessoBean.filtro.possuiAudiencia}" />
							<h:outputText value="Possui audiência" />
						</h:panelGrid>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Ignorado: " style="font-weight: bold" />
						<h:panelGrid columns="2">
							<p:selectBooleanCheckbox label="Ignorado"
								value="#{inicialDeProcessoBean.filtro.ignorado}" />
							<h:outputText value="Ignorado" />
						</h:panelGrid>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Tribunal: " style="font-weight: bold" />
						<p:selectOneMenu autoWidth="false"
							style="width: 350px;font-weight: bold" filter="true"
							filterText="#{msg['commons.pesquisar']}"
							filterMatchMode="contains"
							panelStyle="width:350px;  font-size:0.6em;" title="Tribunal"
							converter="objectConverter"
							value="#{inicialDeProcessoBean.filtro.inicial.tribunal}">
							<f:selectItem itemLabel="Selecione o Tribunal"
								itemValue="#{null}" />
							<f:selectItems value="#{inicialDeProcessoBean.buscaTribunais()}"
								itemLabel="#{tribunal.sigla} - #{tribunal.nome}"
								itemValue="#{tribunal.sigla}" var="tribunal" />
						</p:selectOneMenu>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Estado: " style="font-weight: bold" />
						<p:selectOneMenu autoWidth="false"
							style="width: 350px;font-weight: bold" filter="true"
							filterText="#{msg['commons.pesquisar']}"
							filterMatchMode="contains"
							panelStyle="width:350px;  font-size:0.6em;" title="Estado"
							converter="objectConverter"
							value="#{inicialDeProcessoBean.filtro.inicial.uf}">
							<f:selectItem itemLabel="Selecione o Estado" itemValue="#{null}" />
							<f:selectItems value="#{inicialDeProcessoBean.buscaEstados()}"
								itemLabel="#{estado.nome}" itemValue="#{estado.uf}" var="estado" />
						</p:selectOneMenu>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Areas: " style="font-weight: bold" />
						<p:selectOneMenu autoWidth="false"
							style="width: 350px;font-weight: bold" filter="true"
							filterText="#{msg['commons.pesquisar']}"
							filterMatchMode="contains"
							panelStyle="width:350px;  font-size:0.6em;" title="Area"
							converter="objectConverter"
							value="#{inicialDeProcessoBean.filtro.inicial.area}">
							<f:selectItem itemLabel="Selecione a Area" itemValue="#{null}" />
							<f:selectItems value="#{inicialDeProcessoBean.buscaAreas()}"
								itemLabel="#{area}" itemValue="#{area}" var="area" />
						</p:selectOneMenu>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Data do BPO: " style="font-weight: bold" />
						<h:panelGrid columns="2">
							<h:panelGrid columns="1">
								<h:outputText value="De: " style="font-weight: bold" />
								<p:calendar size="10" value="#{inicialDeProcessoBean.filtro.dataBpoDe}"
									locale="pt" showOtherMonths="true" lang="pt"
									pattern="dd/MM/yyyy" mask="true" />
							</h:panelGrid>
							<h:panelGrid columns="1">
								<h:outputText value="Até: " style="font-weight: bold" />
								<p:calendar size="10"
									value="#{inicialDeProcessoBean.filtro.dataBpoAte}" locale="pt"
									showOtherMonths="true" lang="pt" pattern="dd/MM/yyyy"
									mask="true" />
							</h:panelGrid>
						</h:panelGrid>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Data de distribuição: "
							style="font-weight: bold" />
						<h:panelGrid columns="2">
							<h:panelGrid columns="1">
								<h:outputText value="De: " style="font-weight: bold" />
								<p:calendar size="10"
									value="#{inicialDeProcessoBean.filtro.distribuicaoDataDe}" locale="pt"
									showOtherMonths="true" lang="pt" pattern="dd/MM/yyyy"
									mask="true" />
							</h:panelGrid>
							<h:panelGrid columns="1">
								<h:outputText value="Até: " style="font-weight: bold" />
								<p:calendar size="10"
									value="#{inicialDeProcessoBean.filtro.distribuicaoDataAte}"
									locale="pt" showOtherMonths="true" lang="pt"
									pattern="dd/MM/yyyy" mask="true" />
							</h:panelGrid>
						</h:panelGrid>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="#{msg['page.clientGroup.grupo']}: "
							style="font-weight: bold" />
						<p:selectOneMenu autoWidth="false"
							style="width: 350px;font-weight: bold" filter="true"
							filterText="#{msg['commons.pesquisar']}"
							filterMatchMode="contains"
							panelStyle="width:350px;  font-size:0.6em;"
							title="#{msg['page.clientGroup.grupo']}"
							value="#{inicialDeProcessoBean.filtro.clientGroup}">
							<f:selectItem itemLabel="Selecione o Grupo" itemValue="#{null}" />
							<f:selectItems value="#{clientGroupBean.listClientGroup}"
								itemLabel="#{clientGroup.nome}" itemValue="#{clientGroup}"
								var="clientGroup" />
							<f:converter converterId="clientGroupConverter" />
						</p:selectOneMenu>
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Nome: " style="font-weight: bold" />
						<p:inputText label="Nome" value="#{inicialDeProcessoBean.filtro.nome}"
							style="width:350px" />
					</h:panelGrid>
					<h:panelGrid columns="1">
						<h:outputText value="Status: " style="font-weight: bold" />
						<h:panelGrid columns="2">
							<p:selectBooleanCheckbox label="Liberado"
								value="#{inicialDeProcessoBean.filtro.evento.liberado}" />
							<h:outputText value="Liberado" />
						</h:panelGrid>
					</h:panelGrid>
				</p:panelGrid>
				<p:toolbarGroup>
					<p:commandButton id="btnPesquisar"
						value="#{msg['commons.pesquisar']}" style="font-size: 0.8em;"
						icon="ui-icon-search" update=":detailForm :listForm"
						actionListener="#{inicialDeProcessoBean.pesquisar()}" />
				</p:toolbarGroup>
			</p:panel>
			<p:panelGrid columns="1">
				<p:panel style="margin-bottom:5px; font-size: 12px;">
					<p:dataTable id="inicialTable" rowsPerPageTemplate="10,50,100"
						value="#{inicialDeProcessoBean.dadosEventoDigestoDataModel}" var="eventoDigesto"
						selectionMode="single" paginator="true" lazy="true" rows="10"
						paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						selection="#{inicialDeProcessoBean.eventoDigesto}">

						<p:ajax event="rowSelect" process="@this" update=":detailForm" />

						<p:column headerText="#{msg['page.registration.numero']}">
							<h:outputText value="#{eventoDigesto.targetNumber}" />
						</p:column>
						<p:column headerText="#{msg['page.bpo.initial.liberado']}"
							rendered="#{bpoConfigurationSingleton.twoStepsValidation}">
							<p:selectBooleanCheckbox value="#{eventoDigesto.liberado}"
								disabled="true" />
						</p:column>
						<p:column
							headerText="#{msg['page.bpo.initial.distribution.date']}">
							<h:outputText
								value="#{eventoDigesto.inicial.dataDistribuicao.time}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</p:column>
						<p:column headerText="#{msg['page.bpo.initial.bpo.date']}">
							<h:outputText value="#{eventoDigesto.dataBpo.time}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</p:column>

						<p:column headerText="#{msg['page.bpo.initial.exists']}">
							<p:selectBooleanCheckbox value="#{eventoDigesto.onElaw}"
								disabled="true" />
						</p:column>

					</p:dataTable>
				</p:panel>
			</p:panelGrid>
		</h:form>
		<h:form id="detailForm">
			<p:panel id="detailPanel" widgetVar="detailPanel"
				style="margin-bottom:90px; font-size: 12px;"
				rendered="#{not empty inicialDeProcessoBean.eventoDigesto}"
				closable="true">
				<p:panelGrid columns="1" layout="grid">
					<p:panelGrid columns="8">
						<h:outputText value="#{msg['page.registration.numero']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.targetNumber}" />

						<h:outputText value="#{msg['page.amount.area']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.area}" />

						<h:outputText value="#{msg['page.estado.uf']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.uf}" />

						<h:outputText value="#{msg['page.bpo.initial.tribunal']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.tribunal}" />

						<h:outputText value="#{msg['page.bpo.initial.foro']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.foro}" />

						<h:outputText value="#{msg['page.bpo.initial.distribution.type']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.distribuicaoTipo}" />

						<h:outputText value="#{msg['page.bpo.initial.creation.date']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.dataCriacao.time}">
							<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
						</h:outputText>
						<h:outputText value="#{msg['page.bpo.initial.distribution.date']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.dataDistribuicao.time}">
							<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
						</h:outputText>

						<h:outputText value="#{msg['page.bpo.initial.bpo.date']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.dataBpo.time}">
							<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
						</h:outputText>

						<h:outputText value="#{msg['page.comarca.header']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.comarca}" />

						<h:outputText value="#{msg['page.bpo.initial.nature.class']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.classeNatureza}" />

						<h:outputText value="#{msg['page.bpo.initial.extra.subject']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.assuntoExtra}" />

						<h:outputText value="#{msg['page.bpo.initial.value']}" />
						<h:outputText
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.valor}" />
					</p:panelGrid>
					<hr />

					<p:panelGrid columns="2">
						<p:dataTable
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.anexos}"
							var="anexo" paginator="true" rows="5"
							rendered="#{not empty inicialDeProcessoBean.eventoDigesto.inicial.anexos}">
							<f:facet name="header">
                                #{msg['commons.anexos']}
                            </f:facet>
							<p:column headerText="#{msg['commons.data']}">
								<h:outputText value="#{anexo.dataPublicacao.time}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</p:column>
							<p:column headerText="#{msg['page.bpo.attachment.type']}">
								<h:outputText value="#{anexo.tipoAnexo}" />
							</p:column>
							<p:column headerText="Link Anexo">
								<h:outputLink target="_blank" value="#{anexo.link}">#{msg['page.bpo.attachment.open']}</h:outputLink>
							</p:column>
							<p:column headerText="#{msg['commons.texto']}">
								<p:commandLink
									actionListener="#{inicialDeProcessoBean.exibeTexto(anexo.conteudo)}"
									update="detailForm:textDialog">
									<h:outputText value="#{anexo.conteudoResumido}" />
								</p:commandLink>
							</p:column>
						</p:dataTable>

						<p:dataTable
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.partes}"
							var="parte" paginator="true" rows="5"
							rendered="#{not empty inicialDeProcessoBean.eventoDigesto.inicial.partes}">
							<f:facet name="header">
                                #{msg['commons.partes']}
                            </f:facet>
							<p:column headerText="#{msg['commons.nome']}">
								<h:outputText value="#{parte.nomeParteNormalizado}" />
							</p:column>
							<p:column headerText="#{msg['page.bpo.parte.tipo']}">
								<h:outputText value="#{parte.tipo}" />
							</p:column>
							<p:column headerText="#{msg['page.bpo.parte.relation']}">
								<h:outputText value="#{parte.relacaoNormalizado}" />
							</p:column>

							<p:column headerText="#{msg['page.bpo.parte.hasProcesso']}">
								<p:selectBooleanCheckbox
									value="#{inicialDeProcessoBean.jaPossuiProcesso(parte)}"
									disabled="true" />
							</p:column>

						</p:dataTable>

						<p:dataTable
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.audiencias}"
							var="audiencia" paginator="true" rows="5"
							rendered="#{not empty inicialDeProcessoBean.eventoDigesto.inicial.audiencias}">
							<f:facet name="header">
                                #{msg['page.bpo.initial.audiencias']}
                            </f:facet>
							<p:column headerText="#{msg['commons.data']}">
								<h:outputText value="#{audiencia.data.time}">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
								</h:outputText>
							</p:column>
							<p:column headerText="#{msg['commons.tipo']}">
								<h:outputText value="#{audiencia.tipo}" />
							</p:column>
							<p:column headerText="#{msg['commons.local']}">
								<h:outputText value="#{audiencia.local}" />
							</p:column>
						</p:dataTable>


						<p:dataTable
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.classes}"
							var="classe" paginator="true" rows="5"
							rendered="#{not empty inicialDeProcessoBean.eventoDigesto.inicial.classes}">
							<f:facet name="header">
                                #{msg['page.bpo.initial.classes']}
                            </f:facet>
							<p:column headerText="#{msg['commons.informacao']}">
								<h:outputText value="#{classe}" />
							</p:column>
						</p:dataTable>

					</p:panelGrid>

					<p:panelGrid columns="1">
						<p:dataTable
							value="#{inicialDeProcessoBean.eventoDigesto.inicial.andamentos}"
							var="andamento" paginator="true" rows="5"
							rendered="#{not empty inicialDeProcessoBean.eventoDigesto.inicial.andamentos}">
							<f:facet name="header">
                                #{msg['page.bpo.initial.movimentacoes']}
                            </f:facet>
							<p:column headerText="#{msg['commons.data']}">
								<h:outputText value="#{andamento.data.time}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</p:column>
							<p:column headerText="#{msg['commons.titulo']}">
								<h:outputText value="#{andamento.tipo}" />
							</p:column>
							<p:column headerText="#{msg['commons.texto']}">
								<p:commandLink
									actionListener="#{inicialDeProcessoBean.exibeTexto(andamento.texto)}"
									rendered="#{andamento.textoLongo}"
									update="detailForm:textDialog">
									<h:outputText value="#{andamento.textoLimitado}" />
								</p:commandLink>
								<h:outputText value="#{andamento.textoLimitado}"
									rendered="#{!andamento.textoLongo}" />
							</p:column>
							<p:column
								headerText="#{msg['page.bpo.andamento.tipo.inteligente']}">
								<h:outputText value="#{andamento.tipoInteligenteDigesto}" />
							</p:column>
						</p:dataTable>
					</p:panelGrid>

					<hr />
					<p:panelGrid columns="3">
						<p:commandButton value="#{msg['commons.liberar']}"
							action="#{inicialDeProcessoBean.liberar()}"
							rendered="#{not inicialDeProcessoBean.getEventoLiberado()}"
							process="@this" />
						<p:commandButton value="#{msg['page.bpo.initial.pre.cadastro']}"
							action="#{inicialDeProcessoBean.criarPreCadastro()}" ajax="false"
							onclick="this.form.target='_blank';"
							rendered="#{inicialDeProcessoBean.getEventoLiberado()}"
							process="@this" />
						<p:commandButton value="#{msg['commons.ignorar']}"
							action="#{inicialDeProcessoBean.ignorarInicial()}" process="@this" />
					</p:panelGrid>
				</p:panelGrid>
			</p:panel>

			<p:dialog resizable="false" id="textDialog" widgetVar="textDialog"
				closeOnEscape="true" closable="true" modal="true">
				<p:scrollPanel id="scroll" mode="native"
					style="width:1000px;height:600px">
					<h:outputText value="#{inicialDeProcessoBean.textoParaDialog}" />
				</p:scrollPanel>
			</p:dialog>
		</h:form>

	</ui:define>
</ui:composition>